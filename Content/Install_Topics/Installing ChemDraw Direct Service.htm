<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:conditions="Primary.InstallOnly" MadCap:lastBlockDepth="8" MadCap:lastHeight="5283" MadCap:lastWidth="842">
    <head>
        <link href="../Resources/TableStyles/TableStandard.css" rel="stylesheet" MadCap:stylesheetType="table" />
    </head>
    <body>
        <h1>Installing ChemDraw JS Service</h1>
        <p xmlns="http://www.w3.org/1999/xhtml">A single ChemDraw JS Service can be installed which offers both JavaScript library and the ChemDraw Web Service. </p>
        <p xmlns="http://www.w3.org/1999/xhtml">
            <img src="Images/ChemDrawDirectService.png" alt="ChemDrawDirectService" />
        </p>
        <h2 id="software-prerequisites-1" xmlns="http://www.w3.org/1999/xhtml">Software Prerequisites</h2>
        <p xmlns="http://www.w3.org/1999/xhtml">The following files are needed to perform installation.</p>
        <div class="Bullet1-inner">ChemDraw-JS-Setup-17.1.exe</div>
        <div class="Bullet1-inner">ChemDraw-JS-License.xml</div>
        <p xmlns="http://www.w3.org/1999/xhtml">The following operating systems are supported by the service:</p>
        <div xmlns="http://www.w3.org/1999/xhtml" class="Bullet1-inner">Windows Server 2008 or later</div>
        <p xmlns="http://www.w3.org/1999/xhtml">The following software is depended by ChemDraw JS Service, and will be installed by the installer automatically, if it does not exist:</p>
        <div xmlns="http://www.w3.org/1999/xhtml" class="Bullet1-inner">Microsoft .NET Framework 4.5 or above</div>
        <div xmlns="http://www.w3.org/1999/xhtml" class="Bullet1-inner">Microsoft Visual C++ 2017 Redistributable Package (x86)</div>
        <div xmlns="http://www.w3.org/1999/xhtml" class="Bullet1-inner">PerkinElmer ChemDraw ActiveX Enterprise Constant 17.1</div>
        <h2 id="upgrading-from-earlier-versions" xmlns="http://www.w3.org/1999/xhtml">Upgrading from Earlier Versions</h2>
        <p xmlns="http://www.w3.org/1999/xhtml">Upgrade from earlier version to <MadCap:variable name="Primary.ProductName" /> is not supported. The previous versions need to be uninstalled manually before installing ChemDraw JS 17.1.</p>
        <h2 id="interactive-installation" xmlns="http://www.w3.org/1999/xhtml">Interactive Installation</h2>
        <table style="mc-table-style: url('../Resources/TableStyles/TableStandard.css');width: 100%;margin-left: 0;margin-right: auto;" class="TableStyle-TableStandard" cellspacing="0" xmlns="http://www.w3.org/1999/xhtml">
            <col style="width: 8%;" class="TableStyle-TableStandard-Column-Column1" />
            <col style="width: 50%;" class="TableStyle-TableStandard-Column-Column1" />
            <col style="width: 40%;" class="TableStyle-TableStandard-Column-Column1" />
            <thead>
                <tr class="TableStyle-TableStandard-Head-Header1">
                    <th class="TableStyle-TableStandard-HeadE-Column1-Header1" style="font-weight: bold;">Step</th>
                    <th class="TableStyle-TableStandard-HeadE-Column1-Header1" style="font-weight: bold;">User Input / User Action</th>
                    <th class="TableStyle-TableStandard-HeadD-Column1-Header1" style="font-weight: bold;">Expected Result</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-TableStandard-Body-Body2">
                    <td class="TableStyle-TableStandard-BodyE-Column1-Body2">1</td>
                    <td class="TableStyle-TableStandard-BodyE-Column1-Body2">
                        <p xmlns="">Double-click the <b>ChemDraw-JS-Setup-17.1.exe</b> file. The <i>ChemDraw JS 17.1.0- InstallShield Wizard</i> appears. </p>
                        <p xmlns="">
                            <img src="Images/install-2.PNG" alt="Install-2" style="mc-thumbnail: popup;mc-thumbnail-max-height: 350px;" MadCap:mediastyle="@media print { max-width: 350px; }" />
                            <br />
                        </p>
                        <p xmlns="">Click <strong>Next</strong>. </p>
                        <div xmlns="" class="Note" MadCap:autonum="&lt;b&gt;Note: &lt;/b&gt; ">This installer wizard lists the prerequisites which are not installed on your machine. You may need to follow the on-screen instructions to complete the installation of the prerequisite items.</div>
                    </td>
                    <td class="TableStyle-TableStandard-BodyD-Column1-Body2" xmlns="">
                        <p><i>ChemDraw JS</i> installation begins and the welcome wizard appears after all the dependency software are installed. </p>
                        <p>The <i>License Agreement</i> dialog-box appears.</p>
                    </td>
                </tr>
                <tr class="TableStyle-TableStandard-Body-Body2">
                    <td class="TableStyle-TableStandard-BodyE-Column1-Body2">2</td>
                    <td class="TableStyle-TableStandard-BodyE-Column1-Body2">
                        <img src="Images/install-3.PNG" alt="Install-3" style="mc-thumbnail: popup;mc-thumbnail-max-height: 350px;" MadCap:mediastyle="@media print { max-width: 350px; }" />
                        <br />Read the license agreement, and if you agree with the license agreement, select the <strong>I accept the terms in the license agreement</strong> option, then click <strong>Next</strong>.</td>
                    <td class="TableStyle-TableStandard-BodyD-Column1-Body2" xmlns="">The <i>Destination Folder</i> dialog-box appears.</td>
                </tr>
                <tr class="TableStyle-TableStandard-Body-Body2">
                    <td class="TableStyle-TableStandard-BodyE-Column1-Body2">3</td>
                    <td class="TableStyle-TableStandard-BodyE-Column1-Body2">
                        <p xmlns="">
                            <img src="Images/install-5.PNG" alt="Install-5" style="mc-thumbnail: popup;mc-thumbnail-max-height: 350px;" MadCap:mediastyle="@media print { max-width: 350px; }" />
                            <br />
                        </p>
                        <p xmlns="">Click <strong>Next</strong> to install <MadCap:variable name="Primary.ProductName" /> in the default location. </p>
                        <p xmlns="">Alternatively, you may click <b>Change</b> to change the default destination location and select a new destination folder.</p>
                    </td>
                    <td class="TableStyle-TableStandard-BodyD-Column1-Body2" xmlns="">The <i>Setting ChemDraw JS</i> dialog-box appears.</td>
                </tr>
                <tr class="TableStyle-TableStandard-Body-Body2">
                    <td class="TableStyle-TableStandard-BodyE-Column1-Body2">4</td>
                    <td class="TableStyle-TableStandard-BodyE-Column1-Body2">
                        <p xmlns="">Select the protocol type and configure other respective settings.</p>
                        <p xmlns="">
                            <img src="Images/install-6.PNG" alt="Install-6" xmlns="http://www.w3.org/1999/xhtml" style="mc-thumbnail: popup;mc-thumbnail-max-height: 350px;" MadCap:mediastyle="@media print { max-width: 350px; }" />
                        </p>
                        <p xmlns=""><b>HTTP</b>:</p>
                        <div xmlns="" class="Bullet1-inner"><i>Type</i>: Protocol type: http or https. The type has to be set to https if the host applications are using https.</div>
                        <div xmlns="" class="Bullet1-inner"><i>Host name</i>: Enter the local server machine name or IP address: local machine name as default. The host name has to be public domain name or the public IP address that can be accessed by the end users of the host applications.</div>
                        <div xmlns="" class="Bullet1-inner"><i>Port</i>: Port number of the service. The installation will be rollback if the specified port is not available.</div>
                        <div xmlns="" class="Bullet1-inner"><i>Virtual path</i>: Virtual path of the service.<br />E.g. The virtual path is used in the URL to access ChemDraw JS and Web Service like:<br /><span style="font-family: 'Courier New'; font-size: 9pt;">http://[MACHINE NAME]:81/chemdrawjs/js/sample/index.html</span> or <br /><span style="font-family: 'Courier New'; font-size: 9pt;">http://[MACHINE NAME]:81/chemdrawjs/rest/help</span>.</div>
                        <p xmlns="">
                            <img src="Images/install-7.PNG" alt="Install-7" xmlns="http://www.w3.org/1999/xhtml" style="mc-thumbnail: popup;mc-thumbnail-max-height: 350px;" MadCap:mediastyle="@media print { max-width: 350px; }" />
                        </p>
                        <p xmlns=""><b>HTTPS</b>:</p>
                        <div xmlns="" class="Bullet1-inner"><i>SSL certificate</i>: SSL certificate: Click <b>Select</b> to add a SSL certificate .pfx file.</div>
                        <div xmlns="" class="Bullet1-inner"><i>SSL password</i>: SSL certificate file password: Enter the password of SSL certificate.</div>
                        <p xmlns="">Click <b>Next</b>.</p>
                    </td>
                    <td class="TableStyle-TableStandard-BodyD-Column1-Body2" xmlns="">The <i>Ready to Install the Program</i> dialog-box appears.</td>
                </tr>
                <tr class="TableStyle-TableStandard-Body-Body2">
                    <td class="TableStyle-TableStandard-BodyE-Column1-Body2">5</td>
                    <td class="TableStyle-TableStandard-BodyE-Column1-Body2">
                        <p xmlns="">
                            <img src="Images/install-8.PNG" alt="Install-8" xmlns="http://www.w3.org/1999/xhtml" style="mc-thumbnail: popup;mc-thumbnail-max-height: 350px;" MadCap:mediastyle="@media print { max-width: 350px; }" />
                        </p>
                        <p xmlns="">Click <b>Install</b>.</p>
                    </td>
                    <td class="TableStyle-TableStandard-BodyD-Column1-Body2" xmlns="">Installation begins and the <i>Installing <MadCap:variable name="Primary.ProductName" /></i> dialog appears.</td>
                </tr>
                <tr class="TableStyle-TableStandard-Body-Body2">
                    <td class="TableStyle-TableStandard-BodyE-Column1-Body2">6</td>
                    <td class="TableStyle-TableStandard-BodyE-Column1-Body2">
                        <p xmlns="">
                            <img src="Images/install-10.PNG" alt="Install-10" xmlns="http://www.w3.org/1999/xhtml" style="mc-thumbnail: popup;mc-thumbnail-max-height: 350px;" MadCap:mediastyle="@media print { max-width: 350px; }" />
                        </p>
                        <p xmlns="">The <i>InstallShield Wizard Completed</i> dialog appears when the installation completes. </p>
                        <p xmlns="">Click <b>Finish</b> to exit the wizard.</p>
                    </td>
                    <td class="TableStyle-TableStandard-BodyD-Column1-Body2">The installation wizard exits. The installer log file and <MadCap:variable name="Primary.ProductName" /> sample page opens if the options are checked.</td>
                </tr>
                <tr class="TableStyle-TableStandard-Body-Body2">
                    <td class="TableStyle-TableStandard-BodyB-Column1-Body2">7</td>
                    <td class="TableStyle-TableStandard-BodyB-Column1-Body2">
                        <img src="Images/InstallLicenseRequired.png" MadCap:mediastyle="@media print { max-width: 350px; }" style="mc-thumbnail: popup;mc-thumbnail-max-height: 350px;" xmlns="" />
                        <p xmlns="">The sample page shows if the option <b>Show ChemDraw JS sample page</b> is checked</p>
                    </td>
                    <td class="TableStyle-TableStandard-BodyA-Column1-Body2">&#160;</td>
                </tr>
            </tbody>
        </table>
        <div class="Note" MadCap:autonum="&lt;b&gt;Note: &lt;/b&gt; ">To try the sample page, please refer to <a href="Testing ChemDraw Direct Deployment.htm#Loading">Loading ChemDraw JS License on the Sample Page</a> for details.</div>
        <h2 id="silent-installation" xmlns="http://www.w3.org/1999/xhtml">Silent Installation</h2>
        <p xmlns="http://www.w3.org/1999/xhtml"><strong>Syntax</strong>
        </p>
        <p><pre class="prettyprint" xml:space="preserve">"ChemDraw-JS-17.1.exe" /s /v/"qn SERVER_PORT=[post_number] \
SERVER_TYPE=[server_type] \
SERVER_SSL_PATH=[path_to_pfx_file/your_ssl_pfx_file.pfx] \
SERVER_SSL_PWD=[pfx_file_passware] \
SERVER_HOST_NAME=[MACHINENAME] \
SERVER_VIRPATH=[SERVER_VIRPATH]"</pre>
        </p>
        <p xmlns="http://www.w3.org/1999/xhtml"><strong>Example</strong>
        </p>
        <p><pre class="prettyprint" xml:space="preserve">"ChemDraw-JS-17.1.exe" /s /v/"qn \
SERVER_PORT=443 SERVER_TYPE=https \
SERVER_SSL_PATH=C:\certificate.pfx \
SERVER_SSL_PWD=****** \
SERVER_HOST_NAME=yourappurl.com \
SERVER_VIRPATH=chemdrawjs"</pre>
        </p>
        <p xmlns="http://www.w3.org/1999/xhtml"><strong>Parameters</strong>
        </p>
        <div xmlns="http://www.w3.org/1999/xhtml" class="Bullet1-inner">
    SERVER_PORT: The exposed port of the ChemDraw JS Service.
    </div>
        <div xmlns="http://www.w3.org/1999/xhtml" class="Bullet1-inner">SERVER_TYPE: http or https
    </div>
        <div xmlns="http://www.w3.org/1999/xhtml" class="Bullet1-inner">SERVER_SSL_PATH: The path to the SSL certificate file
    </div>
        <div xmlns="http://www.w3.org/1999/xhtml" class="Bullet1-inner">SERVER_SSL_PWD: The password of the SSL certificate
    </div>
        <div xmlns="http://www.w3.org/1999/xhtml" class="Bullet1-inner">SERVER_HOST_NAME: The public domain name or host name or IP address which can be accessed by the end users of the host applications. This name will be saved into the configuration of ChemDraw JS, so that the ChemDraw JS javascript library can find the backend service.
    </div>
        <div xmlns="http://www.w3.org/1999/xhtml" class="Bullet1-inner">SERVER_VIRPATH: Virtual path of the service. This path can be empty. If using silent installation with empty virtual path, set the param as SERVER_VIRPATH=""
</div>
        <div xmlns="http://www.w3.org/1999/xhtml" class="Note" MadCap:autonum="&lt;b&gt;Note: &lt;/b&gt; ">Administrator permission is required to perform silent installation.</div>
        <h2 id="startingstopping-chemdraw-direct-services" xmlns="http://www.w3.org/1999/xhtml">Starting/Stopping ChemDraw JS Services</h2>
        <p xmlns="http://www.w3.org/1999/xhtml">After installation, the following two windows services are created. Both the services are configured to be started automatically at windows start-up.</p>
        <div class="Bullet1-inner">PerkinElmer ChemDraw JS Service 17.1</div>
        <div class="Bullet1-inner">PerkinElmer ChemDraw JS Service 17.1 Monitor</div>
        <p xmlns="http://www.w3.org/1999/xhtml">To stop the services, the <strong xmlns="http://www.w3.org/1999/xhtml">PerkinElmer ChemDraw JS Service 17.1 Monitor</strong> has to be stopped first. Because the monitor service keeps monitoring the running state of <strong xmlns="http://www.w3.org/1999/xhtml">PerkinElmer ChemDraw JS Service 17.1</strong> and restart the service when it is not running.</p>
    </body>
</html>