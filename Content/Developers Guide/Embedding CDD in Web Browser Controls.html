<?xml version="1.0" encoding="utf-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="3" MadCap:lastHeight="1161" MadCap:lastWidth="907" MadCap:conditions="Primary.DevGuide Only">
    <head>
        <meta http-equiv="Content-Style-Type" content="text/css" /><title></title>
        <style type="text/css">/*<![CDATA[*/
code
{
	white-space: pre;
}

/*]]>*/</style>
        <style type="text/css">/*<![CDATA[*/
div.sourceCode
{
	overflow-x: auto;
}
table.sourceCode,
tr.sourceCode,
td.lineNumbers,
td.sourceCode
{
	margin: 0;
	padding: 0;
	vertical-align: baseline;
	border: none;
}
table.sourceCode
{
	width: 100%;
	line-height: 100%;
}
td.lineNumbers
{
	text-align: right;
	padding-right: 4px;
	padding-left: 4px;
	color: #aaaaaa;
	border-right: 1px solid #aaaaaa;
}
td.sourceCode
{
	padding-left: 5px;
}
code &gt; span.kw
{
	color: #007020;
	font-weight: bold;
}
/* Keyword */
code &gt; span.dt
{
	color: #902000;
}
/* DataType */
code &gt; span.dv
{
	color: #40a070;
}
/* DecVal */
code &gt; span.bn
{
	color: #40a070;
}
/* BaseN */
code &gt; span.fl
{
	color: #40a070;
}
/* Float */
code &gt; span.ch
{
	color: #4070a0;
}
/* Char */
code &gt; span.st
{
	color: #4070a0;
}
/* String */
code &gt; span.co
{
	color: #60a0b0;
	font-style: italic;
}
/* Comment */
code &gt; span.ot
{
	color: #007020;
}
/* Other */
code &gt; span.al
{
	color: #ff0000;
	font-weight: bold;
}
/* Alert */
code &gt; span.fu
{
	color: #06287e;
}
/* Function */
code &gt; span.er
{
	color: #ff0000;
	font-weight: bold;
}
/* Error */
code &gt; span.wa
{
	color: #60a0b0;
	font-weight: bold;
	font-style: italic;
}
/* Warning */
code &gt; span.cn
{
	color: #880000;
}
/* Constant */
code &gt; span.sc
{
	color: #4070a0;
}
/* SpecialChar */
code &gt; span.vs
{
	color: #4070a0;
}
/* VerbatimString */
code &gt; span.ss
{
	color: #bb6688;
}
/* SpecialString */
code &gt; span.im
{
	
}
/* Import */
code &gt; span.va
{
	color: #19177c;
}
/* Variable */
code &gt; span.cf
{
	color: #007020;
	font-weight: bold;
}
/* ControlFlow */
code &gt; span.op
{
	color: #666666;
}
/* Operator */
code &gt; span.bu
{
	
}
/* BuiltIn */
code &gt; span.ex
{
	
}
/* Extension */
code &gt; span.pp
{
	color: #bc7a00;
}
/* Preprocessor */
code &gt; span.at
{
	color: #7d9029;
}
/* Attribute */
code &gt; span.do
{
	color: #ba2121;
	font-style: italic;
}
/* Documentation */
code &gt; span.an
{
	color: #60a0b0;
	font-weight: bold;
	font-style: italic;
}
/* Annotation */
code &gt; span.cv
{
	color: #60a0b0;
	font-weight: bold;
	font-style: italic;
}
/* CommentVar */
code &gt; span.in
{
	color: #60a0b0;
	font-weight: bold;
	font-style: italic;
}
/* Information */

/*]]>*/</style>
    </head>
    <body>
        <h1 id="embedding-cdd-in-web-browser-controls"><a name="Embeddin" xmlns="http://www.w3.org/1999/xhtml"></a>Embedding ChemDraw JS in Web Browser Controls</h1>
        <div class="Body">ChemDraw JS can run in the popular modern browsers such as Google Chrome, Apple Safari, Microsoft Edge, Microsoft IE, Mozilla Firefox, and some web browser controls based on IE or webkit which can be embedded in desktop applications.</div>
        <div class="Body">Extended Copy and Paste feature is impacted because of the lack of browser extension support.</div>
        <div class="Body">The host application needs to implement the following event handlers to support the extended copy paste.</div><pre class="prettyprint"><p class="code">window.addEventListener('cdd_clipboard_extension_request', clipboardExtensionEventHandler);</p><p class="code">window.addEventListener('cdd_clipboard_request', clipboardEventHandler);</p></pre>
        <div class="Body">The following code snippet demonstrates what needs to be implemented to support extended copy paste feature.</div><pre class="prettyprint"><p class="code">function clipboardEventHandler(e) {
  var request = e.detail || {};
  var response = {};
  if (request.method == 'getVersion') {
    response.content = '9999.9999.9999.9999';
    clipboardResponse(response);
    return;
  } else if (request.method == 'get' || request.method == 'getBatch') {
    // Implement your own async method to access the system clipboard
    getSystemClipBoard(getClipboardCallback);
  } else if (request.method == 'set') {
    // Set the data to system clipboard
    clipboardResponse(response);
  }

  function getClipboardCallback(clipboardData) {
    var method = request.method;
    var response = {};
    if (method == 'get') {
      response.content = clipboardData[request.format];
    } else if (method == 'getBatch') {
      response.content = JSON.stringify(clipboardData);
    } else {
      response.content = '';
    }
    clipboardResponse(response);
  }

  function clipboardResponse(response) {
    var customEvent = new CustomEvent('cdd_clipboard_response', { detail: response });
    window.dispatchEvent(customEvent);
  }
}

function clipboardExtensionEventHandler(e) {
  var request = e.detail || {};
  var response = {};
  if (request.method == 'getVersion') {
    response.content = '9999.9999.9999.9999';
  }
  var customEvent = new CustomEvent('cdd_clipboard_extension_response', { detail: response });
  window.dispatchEvent(customEvent);
}</p></pre>
    </body>
</html>